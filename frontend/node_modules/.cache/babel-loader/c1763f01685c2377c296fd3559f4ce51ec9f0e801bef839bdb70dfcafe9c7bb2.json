{"ast":null,"code":"var _jsxFileName = \"/Users/abrahambhatti/Desktop/trainerAI/frontend/src/components/CameraFeed.js\",\n  _s = $RefreshSig$();\nimport React, { useRef, useEffect } from 'react';\nimport './CameraFeed.css';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst POSE_CONNECTIONS = [[11, 12], [11, 23], [12, 24], [23, 24], [11, 13], [13, 15], [12, 14], [14, 16], [23, 25], [25, 27], [24, 26], [26, 28]];\nconst CameraFeed = ({\n  socket,\n  landmarks\n}) => {\n  _s();\n  const videoRef = useRef(null);\n  const captureCanvasRef = useRef(null);\n  const drawCanvasRef = useRef(null);\n  const frameCountRef = useRef(0);\n  useEffect(() => {\n    const setupCamera = async () => {\n      try {\n        const stream = await navigator.mediaDevices.getUserMedia({\n          video: {\n            width: 640,\n            height: 480\n          }\n        });\n        if (videoRef.current) {\n          videoRef.current.srcObject = stream;\n        }\n      } catch (err) {}\n    };\n    setupCamera();\n  }, []);\n  useEffect(() => {\n    if (!socket) {\n      return;\n    }\n    frameCountRef.current = 0;\n    const interval = setInterval(() => {\n      if (socket.connected && videoRef.current && videoRef.current.videoWidth > 0 && videoRef.current.readyState === videoRef.current.HAVE_ENOUGH_DATA) {\n        const canvas = captureCanvasRef.current;\n        const context = canvas.getContext('2d');\n        canvas.width = videoRef.current.videoWidth;\n        canvas.height = videoRef.current.videoHeight;\n        context.drawImage(videoRef.current, 0, 0, canvas.width, canvas.height);\n        const frame = canvas.toDataURL('image/jpeg', 0.8);\n        socket.emit('video_frame', {\n          frame\n        });\n        frameCountRef.current++;\n      }\n    }, 100);\n    return () => {\n      clearInterval(interval);\n    };\n  }, [socket]);\n  useEffect(() => {\n    if (landmarks && landmarks.length > 0 && videoRef.current) {\n      const canvas = drawCanvasRef.current;\n      const ctx = canvas.getContext('2d');\n      canvas.width = videoRef.current.videoWidth;\n      canvas.height = videoRef.current.videoHeight;\n      ctx.clearRect(0, 0, canvas.width, canvas.height);\n      ctx.strokeStyle = '#a855f7';\n      ctx.fillStyle = '#c084fc';\n      ctx.lineWidth = 3;\n      POSE_CONNECTIONS.forEach(([start, end]) => {\n        const s = landmarks[start];\n        const e = landmarks[end];\n        if (s && e && s.visibility > 0.5 && e.visibility > 0.5) {\n          ctx.beginPath();\n          ctx.moveTo(s.x * canvas.width, s.y * canvas.height);\n          ctx.lineTo(e.x * canvas.width, e.y * canvas.height);\n          ctx.stroke();\n        }\n      });\n      ctx.fillStyle = '#f87171';\n      landmarks.forEach(l => {\n        if (l.visibility > 0.5) {\n          ctx.beginPath();\n          ctx.arc(l.x * canvas.width, l.y * canvas.height, 5, 0, 2 * Math.PI);\n          ctx.fill();\n        }\n      });\n    }\n  }, [landmarks]);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"camera-wrapper\",\n    children: [/*#__PURE__*/_jsxDEV(\"video\", {\n      ref: videoRef,\n      autoPlay: true,\n      playsInline: true,\n      muted: true,\n      className: \"camera-video\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 106,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"canvas\", {\n      ref: captureCanvasRef,\n      style: {\n        display: 'none'\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 113,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"canvas\", {\n      ref: drawCanvasRef,\n      className: \"camera-overlay\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 114,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 105,\n    columnNumber: 5\n  }, this);\n};\n_s(CameraFeed, \"mkHNBDXsCRSlwf8H8QCGbCNiSEo=\");\n_c = CameraFeed;\nexport default CameraFeed;\nvar _c;\n$RefreshReg$(_c, \"CameraFeed\");","map":{"version":3,"names":["React","useRef","useEffect","jsxDEV","_jsxDEV","POSE_CONNECTIONS","CameraFeed","socket","landmarks","_s","videoRef","captureCanvasRef","drawCanvasRef","frameCountRef","setupCamera","stream","navigator","mediaDevices","getUserMedia","video","width","height","current","srcObject","err","interval","setInterval","connected","videoWidth","readyState","HAVE_ENOUGH_DATA","canvas","context","getContext","videoHeight","drawImage","frame","toDataURL","emit","clearInterval","length","ctx","clearRect","strokeStyle","fillStyle","lineWidth","forEach","start","end","s","e","visibility","beginPath","moveTo","x","y","lineTo","stroke","l","arc","Math","PI","fill","className","children","ref","autoPlay","playsInline","muted","fileName","_jsxFileName","lineNumber","columnNumber","style","display","_c","$RefreshReg$"],"sources":["/Users/abrahambhatti/Desktop/trainerAI/frontend/src/components/CameraFeed.js"],"sourcesContent":["import React, { useRef, useEffect } from 'react';\nimport './CameraFeed.css';\n\nconst POSE_CONNECTIONS = [\n  [11, 12], [11, 23], [12, 24], [23, 24],\n  [11, 13], [13, 15], [12, 14], [14, 16],\n  [23, 25], [25, 27], [24, 26], [26, 28],\n];\n\nconst CameraFeed = ({ socket, landmarks }) => {\n  const videoRef = useRef(null);\n  const captureCanvasRef = useRef(null);\n  const drawCanvasRef = useRef(null);\n  const frameCountRef = useRef(0);\n\n  useEffect(() => {\n    const setupCamera = async () => {\n      try {\n        const stream = await navigator.mediaDevices.getUserMedia({ \n          video: { \n            width: 640, \n            height: 480 \n          } \n        });\n        if (videoRef.current) {\n          videoRef.current.srcObject = stream;\n        }\n      } catch (err) {\n      }\n    };\n    setupCamera();\n  }, []);\n\n  useEffect(() => {\n    if (!socket) {\n      return;\n    }\n\n    frameCountRef.current = 0;\n\n    const interval = setInterval(() => {\n      if (\n        socket.connected &&\n        videoRef.current &&\n        videoRef.current.videoWidth > 0 &&\n        videoRef.current.readyState === videoRef.current.HAVE_ENOUGH_DATA\n      ) {\n        const canvas = captureCanvasRef.current;\n        const context = canvas.getContext('2d');\n\n        canvas.width = videoRef.current.videoWidth;\n        canvas.height = videoRef.current.videoHeight;\n\n        context.drawImage(videoRef.current, 0, 0, canvas.width, canvas.height);\n\n        const frame = canvas.toDataURL('image/jpeg', 0.8);\n        socket.emit('video_frame', { frame });\n        \n        frameCountRef.current++;\n      }\n    }, 100);\n\n    return () => {\n      clearInterval(interval);\n    };\n  }, [socket]);\n\n  useEffect(() => {\n    if (landmarks && landmarks.length > 0 && videoRef.current) {\n      const canvas = drawCanvasRef.current;\n      const ctx = canvas.getContext('2d');\n\n      canvas.width = videoRef.current.videoWidth;\n      canvas.height = videoRef.current.videoHeight;\n\n      ctx.clearRect(0, 0, canvas.width, canvas.height);\n\n      ctx.strokeStyle = '#a855f7';\n      ctx.fillStyle = '#c084fc';\n      ctx.lineWidth = 3;\n\n      POSE_CONNECTIONS.forEach(([start, end]) => {\n        const s = landmarks[start];\n        const e = landmarks[end];\n        if (s && e && s.visibility > 0.5 && e.visibility > 0.5) {\n          ctx.beginPath();\n          ctx.moveTo(s.x * canvas.width, s.y * canvas.height);\n          ctx.lineTo(e.x * canvas.width, e.y * canvas.height);\n          ctx.stroke();\n        }\n      });\n\n      ctx.fillStyle = '#f87171';\n      landmarks.forEach(l => {\n        if (l.visibility > 0.5) {\n          ctx.beginPath();\n          ctx.arc(l.x * canvas.width, l.y * canvas.height, 5, 0, 2 * Math.PI);\n          ctx.fill();\n        }\n      });\n    }\n  }, [landmarks]);\n\n  return (\n    <div className=\"camera-wrapper\">\n      <video\n        ref={videoRef}\n        autoPlay\n        playsInline\n        muted\n        className=\"camera-video\"\n      />\n      <canvas ref={captureCanvasRef} style={{ display: 'none' }} />\n      <canvas\n        ref={drawCanvasRef}\n        className=\"camera-overlay\"\n      />\n    </div>\n  );\n};\n\nexport default CameraFeed;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}