{"ast":null,"code":"var _jsxFileName = \"/Users/abrahambhatti/Desktop/trainerAI/frontend/src/components/CameraFeed.js\",\n  _s = $RefreshSig$();\n// src/components/CameraFeed.js\nimport React, { useRef, useEffect } from 'react';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst POSE_CONNECTIONS = [\n// Torso\n[11, 12], [11, 23], [12, 24], [23, 24],\n// Arms\n[11, 13], [13, 15], [12, 14], [14, 16],\n// Legs\n[23, 25], [25, 27], [24, 26], [26, 28]];\nconst CameraFeed = ({\n  socket,\n  landmarks\n}) => {\n  _s();\n  const videoRef = useRef(null);\n  const captureCanvasRef = useRef(null);\n  const drawCanvasRef = useRef(null);\n\n  // Start camera and send frames to backend\n  useEffect(() => {\n    const setupCamera = async () => {\n      try {\n        const stream = await navigator.mediaDevices.getUserMedia({\n          video: true\n        });\n        if (videoRef.current) {\n          videoRef.current.srcObject = stream;\n          await videoRef.current.play();\n        }\n      } catch (err) {\n        console.error('Error accessing camera: ', err);\n      }\n    };\n    setupCamera();\n    const interval = setInterval(() => {\n      console.log('interval tick', 'hasSocket=', !!socket, 'connected=', socket && socket.connected, 'videoWidth=', videoRef.current && videoRef.current.videoWidth);\n      if (socket && socket.connected && videoRef.current && videoRef.current.videoWidth > 0) {\n        const canvas = captureCanvasRef.current;\n        const context = canvas.getContext('2d');\n        canvas.width = videoRef.current.videoWidth;\n        canvas.height = videoRef.current.videoHeight;\n        context.drawImage(videoRef.current, 0, 0, canvas.width, canvas.height);\n        const frame = canvas.toDataURL('image/jpeg');\n        console.log('Sending frame to backend');\n        socket.emit('video_frame', {\n          frame\n        });\n      }\n    }, 100); // ~10 fps\n\n    return () => {\n      clearInterval(interval);\n    };\n  }, [socket]);\n\n  // Draw pose overlay from landmarks received from backend\n  useEffect(() => {\n    if (landmarks && landmarks.length > 0 && videoRef.current) {\n      const canvas = drawCanvasRef.current;\n      const ctx = canvas.getContext('2d');\n      canvas.width = videoRef.current.videoWidth;\n      canvas.height = videoRef.current.videoHeight;\n      ctx.clearRect(0, 0, canvas.width, canvas.height);\n\n      // Draw connections\n      ctx.strokeStyle = 'lime';\n      ctx.lineWidth = 2;\n      POSE_CONNECTIONS.forEach(conn => {\n        const [start, end] = conn;\n        const ls = landmarks[start];\n        const le = landmarks[end];\n        if (ls && le && ls.visibility > 0.5 && le.visibility > 0.5) {\n          ctx.beginPath();\n          ctx.moveTo(ls.x * canvas.width, ls.y * canvas.height);\n          ctx.lineTo(le.x * canvas.width, le.y * canvas.height);\n          ctx.stroke();\n        }\n      });\n\n      // Draw landmarks\n      ctx.fillStyle = 'red';\n      landmarks.forEach(l => {\n        if (l.visibility > 0.5) {\n          ctx.beginPath();\n          ctx.arc(l.x * canvas.width, l.y * canvas.height, 4, 0, 2 * Math.PI);\n          ctx.fill();\n        }\n      });\n    }\n  }, [landmarks]);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"camera-wrapper\",\n    style: {\n      position: 'relative'\n    },\n    children: [/*#__PURE__*/_jsxDEV(\"video\", {\n      ref: videoRef,\n      autoPlay: true,\n      playsInline: true,\n      style: {\n        width: '100%',\n        transform: 'scaleX(-1)'\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 114,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"canvas\", {\n      ref: captureCanvasRef,\n      style: {\n        display: 'none'\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 120,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"canvas\", {\n      ref: drawCanvasRef,\n      style: {\n        position: 'absolute',\n        top: 0,\n        left: 0,\n        width: '100%',\n        height: '100%',\n        pointerEvents: 'none'\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 124,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 113,\n    columnNumber: 5\n  }, this);\n};\n_s(CameraFeed, \"v6YQVY8Wz2m8LkuAzxCMIHx80tU=\");\n_c = CameraFeed;\nexport default CameraFeed;\nvar _c;\n$RefreshReg$(_c, \"CameraFeed\");","map":{"version":3,"names":["React","useRef","useEffect","jsxDEV","_jsxDEV","POSE_CONNECTIONS","CameraFeed","socket","landmarks","_s","videoRef","captureCanvasRef","drawCanvasRef","setupCamera","stream","navigator","mediaDevices","getUserMedia","video","current","srcObject","play","err","console","error","interval","setInterval","log","connected","videoWidth","canvas","context","getContext","width","height","videoHeight","drawImage","frame","toDataURL","emit","clearInterval","length","ctx","clearRect","strokeStyle","lineWidth","forEach","conn","start","end","ls","le","visibility","beginPath","moveTo","x","y","lineTo","stroke","fillStyle","l","arc","Math","PI","fill","className","style","position","children","ref","autoPlay","playsInline","transform","fileName","_jsxFileName","lineNumber","columnNumber","display","top","left","pointerEvents","_c","$RefreshReg$"],"sources":["/Users/abrahambhatti/Desktop/trainerAI/frontend/src/components/CameraFeed.js"],"sourcesContent":["// src/components/CameraFeed.js\nimport React, { useRef, useEffect } from 'react';\n\nconst POSE_CONNECTIONS = [\n  // Torso\n  [11, 12], [11, 23], [12, 24], [23, 24],\n  // Arms\n  [11, 13], [13, 15], [12, 14], [14, 16],\n  // Legs\n  [23, 25], [25, 27], [24, 26], [26, 28],\n];\n\nconst CameraFeed = ({ socket, landmarks }) => {\n  const videoRef = useRef(null);\n  const captureCanvasRef = useRef(null);\n  const drawCanvasRef = useRef(null);\n\n  // Start camera and send frames to backend\n  useEffect(() => {\n    const setupCamera = async () => {\n      try {\n        const stream = await navigator.mediaDevices.getUserMedia({ video: true });\n        if (videoRef.current) {\n          videoRef.current.srcObject = stream;\n          await videoRef.current.play();\n        }\n      } catch (err) {\n        console.error('Error accessing camera: ', err);\n      }\n    };\n\n    setupCamera();\n\n    const interval = setInterval(() => {\n      console.log(\n        'interval tick',\n        'hasSocket=', !!socket,\n        'connected=', socket && socket.connected,\n        'videoWidth=', videoRef.current && videoRef.current.videoWidth\n      );\n\n      if (\n        socket &&\n        socket.connected &&\n        videoRef.current &&\n        videoRef.current.videoWidth > 0\n      ) {\n        const canvas = captureCanvasRef.current;\n        const context = canvas.getContext('2d');\n\n        canvas.width = videoRef.current.videoWidth;\n        canvas.height = videoRef.current.videoHeight;\n\n        context.drawImage(videoRef.current, 0, 0, canvas.width, canvas.height);\n\n        const frame = canvas.toDataURL('image/jpeg');\n        console.log('Sending frame to backend');\n        socket.emit('video_frame', { frame });\n      }\n    }, 100); // ~10 fps\n\n    return () => {\n      clearInterval(interval);\n    };\n  }, [socket]);\n\n  // Draw pose overlay from landmarks received from backend\n  useEffect(() => {\n    if (landmarks && landmarks.length > 0 && videoRef.current) {\n      const canvas = drawCanvasRef.current;\n      const ctx = canvas.getContext('2d');\n\n      canvas.width = videoRef.current.videoWidth;\n      canvas.height = videoRef.current.videoHeight;\n\n      ctx.clearRect(0, 0, canvas.width, canvas.height);\n\n      // Draw connections\n      ctx.strokeStyle = 'lime';\n      ctx.lineWidth = 2;\n\n      POSE_CONNECTIONS.forEach(conn => {\n        const [start, end] = conn;\n        const ls = landmarks[start];\n        const le = landmarks[end];\n\n        if (\n          ls &&\n          le &&\n          ls.visibility > 0.5 &&\n          le.visibility > 0.5\n        ) {\n          ctx.beginPath();\n          ctx.moveTo(ls.x * canvas.width, ls.y * canvas.height);\n          ctx.lineTo(le.x * canvas.width, le.y * canvas.height);\n          ctx.stroke();\n        }\n      });\n\n      // Draw landmarks\n      ctx.fillStyle = 'red';\n      landmarks.forEach(l => {\n        if (l.visibility > 0.5) {\n          ctx.beginPath();\n          ctx.arc(l.x * canvas.width, l.y * canvas.height, 4, 0, 2 * Math.PI);\n          ctx.fill();\n        }\n      });\n    }\n  }, [landmarks]);\n\n  return (\n    <div className=\"camera-wrapper\" style={{ position: 'relative' }}>\n      <video\n        ref={videoRef}\n        autoPlay\n        playsInline\n        style={{ width: '100%', transform: 'scaleX(-1)' }}\n      />\n      <canvas\n        ref={captureCanvasRef}\n        style={{ display: 'none' }}\n      />\n      <canvas\n        ref={drawCanvasRef}\n        style={{\n          position: 'absolute',\n          top: 0,\n          left: 0,\n          width: '100%',\n          height: '100%',\n          pointerEvents: 'none',\n        }}\n      />\n    </div>\n  );\n};\n\nexport default CameraFeed;\n"],"mappings":";;AAAA;AACA,OAAOA,KAAK,IAAIC,MAAM,EAAEC,SAAS,QAAQ,OAAO;AAAC,SAAAC,MAAA,IAAAC,OAAA;AAEjD,MAAMC,gBAAgB,GAAG;AACvB;AACA,CAAC,EAAE,EAAE,EAAE,CAAC,EAAE,CAAC,EAAE,EAAE,EAAE,CAAC,EAAE,CAAC,EAAE,EAAE,EAAE,CAAC,EAAE,CAAC,EAAE,EAAE,EAAE,CAAC;AACtC;AACA,CAAC,EAAE,EAAE,EAAE,CAAC,EAAE,CAAC,EAAE,EAAE,EAAE,CAAC,EAAE,CAAC,EAAE,EAAE,EAAE,CAAC,EAAE,CAAC,EAAE,EAAE,EAAE,CAAC;AACtC;AACA,CAAC,EAAE,EAAE,EAAE,CAAC,EAAE,CAAC,EAAE,EAAE,EAAE,CAAC,EAAE,CAAC,EAAE,EAAE,EAAE,CAAC,EAAE,CAAC,EAAE,EAAE,EAAE,CAAC,CACvC;AAED,MAAMC,UAAU,GAAGA,CAAC;EAAEC,MAAM;EAAEC;AAAU,CAAC,KAAK;EAAAC,EAAA;EAC5C,MAAMC,QAAQ,GAAGT,MAAM,CAAC,IAAI,CAAC;EAC7B,MAAMU,gBAAgB,GAAGV,MAAM,CAAC,IAAI,CAAC;EACrC,MAAMW,aAAa,GAAGX,MAAM,CAAC,IAAI,CAAC;;EAElC;EACAC,SAAS,CAAC,MAAM;IACd,MAAMW,WAAW,GAAG,MAAAA,CAAA,KAAY;MAC9B,IAAI;QACF,MAAMC,MAAM,GAAG,MAAMC,SAAS,CAACC,YAAY,CAACC,YAAY,CAAC;UAAEC,KAAK,EAAE;QAAK,CAAC,CAAC;QACzE,IAAIR,QAAQ,CAACS,OAAO,EAAE;UACpBT,QAAQ,CAACS,OAAO,CAACC,SAAS,GAAGN,MAAM;UACnC,MAAMJ,QAAQ,CAACS,OAAO,CAACE,IAAI,CAAC,CAAC;QAC/B;MACF,CAAC,CAAC,OAAOC,GAAG,EAAE;QACZC,OAAO,CAACC,KAAK,CAAC,0BAA0B,EAAEF,GAAG,CAAC;MAChD;IACF,CAAC;IAEDT,WAAW,CAAC,CAAC;IAEb,MAAMY,QAAQ,GAAGC,WAAW,CAAC,MAAM;MACjCH,OAAO,CAACI,GAAG,CACT,eAAe,EACf,YAAY,EAAE,CAAC,CAACpB,MAAM,EACtB,YAAY,EAAEA,MAAM,IAAIA,MAAM,CAACqB,SAAS,EACxC,aAAa,EAAElB,QAAQ,CAACS,OAAO,IAAIT,QAAQ,CAACS,OAAO,CAACU,UACtD,CAAC;MAED,IACEtB,MAAM,IACNA,MAAM,CAACqB,SAAS,IAChBlB,QAAQ,CAACS,OAAO,IAChBT,QAAQ,CAACS,OAAO,CAACU,UAAU,GAAG,CAAC,EAC/B;QACA,MAAMC,MAAM,GAAGnB,gBAAgB,CAACQ,OAAO;QACvC,MAAMY,OAAO,GAAGD,MAAM,CAACE,UAAU,CAAC,IAAI,CAAC;QAEvCF,MAAM,CAACG,KAAK,GAAGvB,QAAQ,CAACS,OAAO,CAACU,UAAU;QAC1CC,MAAM,CAACI,MAAM,GAAGxB,QAAQ,CAACS,OAAO,CAACgB,WAAW;QAE5CJ,OAAO,CAACK,SAAS,CAAC1B,QAAQ,CAACS,OAAO,EAAE,CAAC,EAAE,CAAC,EAAEW,MAAM,CAACG,KAAK,EAAEH,MAAM,CAACI,MAAM,CAAC;QAEtE,MAAMG,KAAK,GAAGP,MAAM,CAACQ,SAAS,CAAC,YAAY,CAAC;QAC5Cf,OAAO,CAACI,GAAG,CAAC,0BAA0B,CAAC;QACvCpB,MAAM,CAACgC,IAAI,CAAC,aAAa,EAAE;UAAEF;QAAM,CAAC,CAAC;MACvC;IACF,CAAC,EAAE,GAAG,CAAC,CAAC,CAAC;;IAET,OAAO,MAAM;MACXG,aAAa,CAACf,QAAQ,CAAC;IACzB,CAAC;EACH,CAAC,EAAE,CAAClB,MAAM,CAAC,CAAC;;EAEZ;EACAL,SAAS,CAAC,MAAM;IACd,IAAIM,SAAS,IAAIA,SAAS,CAACiC,MAAM,GAAG,CAAC,IAAI/B,QAAQ,CAACS,OAAO,EAAE;MACzD,MAAMW,MAAM,GAAGlB,aAAa,CAACO,OAAO;MACpC,MAAMuB,GAAG,GAAGZ,MAAM,CAACE,UAAU,CAAC,IAAI,CAAC;MAEnCF,MAAM,CAACG,KAAK,GAAGvB,QAAQ,CAACS,OAAO,CAACU,UAAU;MAC1CC,MAAM,CAACI,MAAM,GAAGxB,QAAQ,CAACS,OAAO,CAACgB,WAAW;MAE5CO,GAAG,CAACC,SAAS,CAAC,CAAC,EAAE,CAAC,EAAEb,MAAM,CAACG,KAAK,EAAEH,MAAM,CAACI,MAAM,CAAC;;MAEhD;MACAQ,GAAG,CAACE,WAAW,GAAG,MAAM;MACxBF,GAAG,CAACG,SAAS,GAAG,CAAC;MAEjBxC,gBAAgB,CAACyC,OAAO,CAACC,IAAI,IAAI;QAC/B,MAAM,CAACC,KAAK,EAAEC,GAAG,CAAC,GAAGF,IAAI;QACzB,MAAMG,EAAE,GAAG1C,SAAS,CAACwC,KAAK,CAAC;QAC3B,MAAMG,EAAE,GAAG3C,SAAS,CAACyC,GAAG,CAAC;QAEzB,IACEC,EAAE,IACFC,EAAE,IACFD,EAAE,CAACE,UAAU,GAAG,GAAG,IACnBD,EAAE,CAACC,UAAU,GAAG,GAAG,EACnB;UACAV,GAAG,CAACW,SAAS,CAAC,CAAC;UACfX,GAAG,CAACY,MAAM,CAACJ,EAAE,CAACK,CAAC,GAAGzB,MAAM,CAACG,KAAK,EAAEiB,EAAE,CAACM,CAAC,GAAG1B,MAAM,CAACI,MAAM,CAAC;UACrDQ,GAAG,CAACe,MAAM,CAACN,EAAE,CAACI,CAAC,GAAGzB,MAAM,CAACG,KAAK,EAAEkB,EAAE,CAACK,CAAC,GAAG1B,MAAM,CAACI,MAAM,CAAC;UACrDQ,GAAG,CAACgB,MAAM,CAAC,CAAC;QACd;MACF,CAAC,CAAC;;MAEF;MACAhB,GAAG,CAACiB,SAAS,GAAG,KAAK;MACrBnD,SAAS,CAACsC,OAAO,CAACc,CAAC,IAAI;QACrB,IAAIA,CAAC,CAACR,UAAU,GAAG,GAAG,EAAE;UACtBV,GAAG,CAACW,SAAS,CAAC,CAAC;UACfX,GAAG,CAACmB,GAAG,CAACD,CAAC,CAACL,CAAC,GAAGzB,MAAM,CAACG,KAAK,EAAE2B,CAAC,CAACJ,CAAC,GAAG1B,MAAM,CAACI,MAAM,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,GAAG4B,IAAI,CAACC,EAAE,CAAC;UACnErB,GAAG,CAACsB,IAAI,CAAC,CAAC;QACZ;MACF,CAAC,CAAC;IACJ;EACF,CAAC,EAAE,CAACxD,SAAS,CAAC,CAAC;EAEf,oBACEJ,OAAA;IAAK6D,SAAS,EAAC,gBAAgB;IAACC,KAAK,EAAE;MAAEC,QAAQ,EAAE;IAAW,CAAE;IAAAC,QAAA,gBAC9DhE,OAAA;MACEiE,GAAG,EAAE3D,QAAS;MACd4D,QAAQ;MACRC,WAAW;MACXL,KAAK,EAAE;QAAEjC,KAAK,EAAE,MAAM;QAAEuC,SAAS,EAAE;MAAa;IAAE;MAAAC,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACnD,CAAC,eACFxE,OAAA;MACEiE,GAAG,EAAE1D,gBAAiB;MACtBuD,KAAK,EAAE;QAAEW,OAAO,EAAE;MAAO;IAAE;MAAAJ,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAC5B,CAAC,eACFxE,OAAA;MACEiE,GAAG,EAAEzD,aAAc;MACnBsD,KAAK,EAAE;QACLC,QAAQ,EAAE,UAAU;QACpBW,GAAG,EAAE,CAAC;QACNC,IAAI,EAAE,CAAC;QACP9C,KAAK,EAAE,MAAM;QACbC,MAAM,EAAE,MAAM;QACd8C,aAAa,EAAE;MACjB;IAAE;MAAAP,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACH,CAAC;EAAA;IAAAH,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OACC,CAAC;AAEV,CAAC;AAACnE,EAAA,CA5HIH,UAAU;AAAA2E,EAAA,GAAV3E,UAAU;AA8HhB,eAAeA,UAAU;AAAC,IAAA2E,EAAA;AAAAC,YAAA,CAAAD,EAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}