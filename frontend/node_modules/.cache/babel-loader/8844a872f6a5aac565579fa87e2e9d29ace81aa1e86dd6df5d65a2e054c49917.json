{"ast":null,"code":"var _jsxFileName = \"/Users/abrahambhatti/Desktop/trainerAI/frontend/src/components/CameraFeed.js\",\n  _s = $RefreshSig$();\nimport React, { useRef, useEffect } from 'react';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst POSE_CONNECTIONS = [[11, 12], [11, 23], [12, 24], [23, 24], [11, 13], [13, 15], [12, 14], [14, 16], [23, 25], [25, 27], [24, 26], [26, 28]];\nconst CameraFeed = ({\n  socket,\n  landmarks\n}) => {\n  _s();\n  const videoRef = useRef(null);\n  const captureCanvasRef = useRef(null);\n  const drawCanvasRef = useRef(null);\n  const frameCountRef = useRef(0);\n\n  // Start camera\n  useEffect(() => {\n    const setupCamera = async () => {\n      try {\n        const stream = await navigator.mediaDevices.getUserMedia({\n          video: {\n            width: 640,\n            height: 480\n          }\n        });\n        if (videoRef.current) {\n          videoRef.current.srcObject = stream;\n          console.log('ðŸ“¹ Camera started successfully');\n        }\n      } catch (err) {\n        console.error('âŒ Error accessing camera:', err);\n      }\n    };\n    setupCamera();\n  }, []);\n\n  // Send frames\n  useEffect(() => {\n    if (!socket) {\n      console.log('âš ï¸ No socket yet in CameraFeed');\n      return;\n    }\n    console.log('ðŸŽ¬ Starting frame capture interval');\n    frameCountRef.current = 0;\n    const interval = setInterval(() => {\n      if (socket.connected && videoRef.current && videoRef.current.videoWidth > 0 && videoRef.current.readyState === videoRef.current.HAVE_ENOUGH_DATA) {\n        const canvas = captureCanvasRef.current;\n        const context = canvas.getContext('2d');\n        canvas.width = videoRef.current.videoWidth;\n        canvas.height = videoRef.current.videoHeight;\n        context.drawImage(videoRef.current, 0, 0, canvas.width, canvas.height);\n        const frame = canvas.toDataURL('image/jpeg', 0.8);\n        socket.emit('video_frame', {\n          frame\n        });\n        frameCountRef.current++;\n        if (frameCountRef.current % 10 === 0) {\n          console.log(`ðŸ“¤ Sent ${frameCountRef.current} frames`);\n        }\n      } else {\n        var _videoRef$current, _videoRef$current2;\n        console.log('â¸ï¸ Skipping frame - not ready:', {\n          connected: socket.connected,\n          videoWidth: (_videoRef$current = videoRef.current) === null || _videoRef$current === void 0 ? void 0 : _videoRef$current.videoWidth,\n          readyState: (_videoRef$current2 = videoRef.current) === null || _videoRef$current2 === void 0 ? void 0 : _videoRef$current2.readyState\n        });\n      }\n    }, 100);\n    return () => {\n      console.log('ðŸ›‘ Stopping frame capture');\n      clearInterval(interval);\n    };\n  }, [socket]);\n\n  // Draw landmarks\n  useEffect(() => {\n    if (landmarks && landmarks.length > 0 && videoRef.current) {\n      const canvas = drawCanvasRef.current;\n      const ctx = canvas.getContext('2d');\n      canvas.width = videoRef.current.videoWidth;\n      canvas.height = videoRef.current.videoHeight;\n      ctx.clearRect(0, 0, canvas.width, canvas.height);\n      ctx.strokeStyle = 'lime';\n      ctx.lineWidth = 2;\n      POSE_CONNECTIONS.forEach(([start, end]) => {\n        const s = landmarks[start];\n        const e = landmarks[end];\n        if (s && e && s.visibility > 0.5 && e.visibility > 0.5) {\n          ctx.beginPath();\n          ctx.moveTo(s.x * canvas.width, s.y * canvas.height);\n          ctx.lineTo(e.x * canvas.width, e.y * canvas.height);\n          ctx.stroke();\n        }\n      });\n      ctx.fillStyle = 'red';\n      landmarks.forEach(l => {\n        if (l.visibility > 0.5) {\n          ctx.beginPath();\n          ctx.arc(l.x * canvas.width, l.y * canvas.height, 4, 0, 2 * Math.PI);\n          ctx.fill();\n        }\n      });\n    }\n  }, [landmarks]);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"camera-wrapper\",\n    style: {\n      position: 'relative'\n    },\n    children: [/*#__PURE__*/_jsxDEV(\"video\", {\n      ref: videoRef,\n      autoPlay: true,\n      playsInline: true,\n      muted: true,\n      style: {\n        width: '100%',\n        transform: 'scaleX(-1)'\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 121,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"canvas\", {\n      ref: captureCanvasRef,\n      style: {\n        display: 'none'\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 128,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"canvas\", {\n      ref: drawCanvasRef,\n      style: {\n        position: 'absolute',\n        top: 0,\n        left: 0,\n        width: '100%',\n        height: '100%',\n        pointerEvents: 'none',\n        transform: 'scaleX(-1)'\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 129,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 120,\n    columnNumber: 5\n  }, this);\n};\n_s(CameraFeed, \"mkHNBDXsCRSlwf8H8QCGbCNiSEo=\");\n_c = CameraFeed;\nexport default CameraFeed;\nvar _c;\n$RefreshReg$(_c, \"CameraFeed\");","map":{"version":3,"names":["React","useRef","useEffect","jsxDEV","_jsxDEV","POSE_CONNECTIONS","CameraFeed","socket","landmarks","_s","videoRef","captureCanvasRef","drawCanvasRef","frameCountRef","setupCamera","stream","navigator","mediaDevices","getUserMedia","video","width","height","current","srcObject","console","log","err","error","interval","setInterval","connected","videoWidth","readyState","HAVE_ENOUGH_DATA","canvas","context","getContext","videoHeight","drawImage","frame","toDataURL","emit","_videoRef$current","_videoRef$current2","clearInterval","length","ctx","clearRect","strokeStyle","lineWidth","forEach","start","end","s","e","visibility","beginPath","moveTo","x","y","lineTo","stroke","fillStyle","l","arc","Math","PI","fill","className","style","position","children","ref","autoPlay","playsInline","muted","transform","fileName","_jsxFileName","lineNumber","columnNumber","display","top","left","pointerEvents","_c","$RefreshReg$"],"sources":["/Users/abrahambhatti/Desktop/trainerAI/frontend/src/components/CameraFeed.js"],"sourcesContent":["import React, { useRef, useEffect } from 'react';\n\nconst POSE_CONNECTIONS = [\n  [11, 12], [11, 23], [12, 24], [23, 24],\n  [11, 13], [13, 15], [12, 14], [14, 16],\n  [23, 25], [25, 27], [24, 26], [26, 28],\n];\n\nconst CameraFeed = ({ socket, landmarks }) => {\n  const videoRef = useRef(null);\n  const captureCanvasRef = useRef(null);\n  const drawCanvasRef = useRef(null);\n  const frameCountRef = useRef(0);\n\n  // Start camera\n  useEffect(() => {\n    const setupCamera = async () => {\n      try {\n        const stream = await navigator.mediaDevices.getUserMedia({ \n          video: { \n            width: 640, \n            height: 480 \n          } \n        });\n        if (videoRef.current) {\n          videoRef.current.srcObject = stream;\n          console.log('ðŸ“¹ Camera started successfully');\n        }\n      } catch (err) {\n        console.error('âŒ Error accessing camera:', err);\n      }\n    };\n    setupCamera();\n  }, []);\n\n  // Send frames\n  useEffect(() => {\n    if (!socket) {\n      console.log('âš ï¸ No socket yet in CameraFeed');\n      return;\n    }\n\n    console.log('ðŸŽ¬ Starting frame capture interval');\n    frameCountRef.current = 0;\n\n    const interval = setInterval(() => {\n      if (\n        socket.connected &&\n        videoRef.current &&\n        videoRef.current.videoWidth > 0 &&\n        videoRef.current.readyState === videoRef.current.HAVE_ENOUGH_DATA\n      ) {\n        const canvas = captureCanvasRef.current;\n        const context = canvas.getContext('2d');\n\n        canvas.width = videoRef.current.videoWidth;\n        canvas.height = videoRef.current.videoHeight;\n\n        context.drawImage(videoRef.current, 0, 0, canvas.width, canvas.height);\n\n        const frame = canvas.toDataURL('image/jpeg', 0.8);\n        socket.emit('video_frame', { frame });\n        \n        frameCountRef.current++;\n        if (frameCountRef.current % 10 === 0) {\n          console.log(`ðŸ“¤ Sent ${frameCountRef.current} frames`);\n        }\n      } else {\n        console.log('â¸ï¸ Skipping frame - not ready:', {\n          connected: socket.connected,\n          videoWidth: videoRef.current?.videoWidth,\n          readyState: videoRef.current?.readyState\n        });\n      }\n    }, 100);\n\n    return () => {\n      console.log('ðŸ›‘ Stopping frame capture');\n      clearInterval(interval);\n    };\n  }, [socket]);\n\n  // Draw landmarks\n  useEffect(() => {\n    if (landmarks && landmarks.length > 0 && videoRef.current) {\n      const canvas = drawCanvasRef.current;\n      const ctx = canvas.getContext('2d');\n\n      canvas.width = videoRef.current.videoWidth;\n      canvas.height = videoRef.current.videoHeight;\n\n      ctx.clearRect(0, 0, canvas.width, canvas.height);\n\n      ctx.strokeStyle = 'lime';\n      ctx.lineWidth = 2;\n\n      POSE_CONNECTIONS.forEach(([start, end]) => {\n        const s = landmarks[start];\n        const e = landmarks[end];\n        if (s && e && s.visibility > 0.5 && e.visibility > 0.5) {\n          ctx.beginPath();\n          ctx.moveTo(s.x * canvas.width, s.y * canvas.height);\n          ctx.lineTo(e.x * canvas.width, e.y * canvas.height);\n          ctx.stroke();\n        }\n      });\n\n      ctx.fillStyle = 'red';\n      landmarks.forEach(l => {\n        if (l.visibility > 0.5) {\n          ctx.beginPath();\n          ctx.arc(l.x * canvas.width, l.y * canvas.height, 4, 0, 2 * Math.PI);\n          ctx.fill();\n        }\n      });\n    }\n  }, [landmarks]);\n\n  return (\n    <div className=\"camera-wrapper\" style={{ position: 'relative' }}>\n      <video\n        ref={videoRef}\n        autoPlay\n        playsInline\n        muted\n        style={{ width: '100%', transform: 'scaleX(-1)' }}\n      />\n      <canvas ref={captureCanvasRef} style={{ display: 'none' }} />\n      <canvas\n        ref={drawCanvasRef}\n        style={{\n          position: 'absolute',\n          top: 0,\n          left: 0,\n          width: '100%',\n          height: '100%',\n          pointerEvents: 'none',\n          transform: 'scaleX(-1)'\n        }}\n      />\n    </div>\n  );\n};\n\nexport default CameraFeed;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}