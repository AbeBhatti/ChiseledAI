{"ast":null,"code":"var _jsxFileName = \"/Users/abrahambhatti/Desktop/trainerAI/frontend/src/components/CameraFeed.js\",\n  _s = $RefreshSig$();\nimport React, { useRef, useEffect } from 'react';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst POSE_CONNECTIONS = [[11, 12], [11, 23], [12, 24], [23, 24], [11, 13], [13, 15], [12, 14], [14, 16], [23, 25], [25, 27], [24, 26], [26, 28]];\nconst CameraFeed = ({\n  socket,\n  landmarks\n}) => {\n  _s();\n  const videoRef = useRef(null);\n  const captureCanvasRef = useRef(null);\n  const drawCanvasRef = useRef(null);\n\n  // Start camera\n  useEffect(() => {\n    const setupCamera = async () => {\n      try {\n        const stream = await navigator.mediaDevices.getUserMedia({\n          video: true\n        });\n        if (videoRef.current) {\n          videoRef.current.srcObject = stream;\n        }\n      } catch (err) {\n        console.error('Error accessing camera: ', err);\n      }\n    };\n    setupCamera();\n  }, []);\n\n  // Send frames\n  useEffect(() => {\n    if (!socket) {\n      console.log('No socket yet in CameraFeed');\n      return;\n    }\n    const interval = setInterval(() => {\n      console.log('interval tick', 'hasSocket=', !!socket, 'connected=', socket.connected, 'videoWidth=', videoRef.current && videoRef.current.videoWidth);\n      if (socket.connected && videoRef.current && videoRef.current.videoWidth > 0) {\n        const canvas = captureCanvasRef.current;\n        const context = canvas.getContext('2d');\n        canvas.width = videoRef.current.videoWidth;\n        canvas.height = videoRef.current.videoHeight;\n        context.drawImage(videoRef.current, 0, 0, canvas.width, canvas.height);\n        const frame = canvas.toDataURL('image/jpeg');\n        console.log('Sending frame to backend');\n        socket.emit('video_frame', {\n          frame\n        });\n      }\n    }, 100);\n    return () => clearInterval(interval);\n  }, [socket]);\n\n  // Draw landmarks\n  useEffect(() => {\n    if (landmarks && landmarks.length > 0 && videoRef.current) {\n      const canvas = drawCanvasRef.current;\n      const ctx = canvas.getContext('2d');\n      canvas.width = videoRef.current.videoWidth;\n      canvas.height = videoRef.current.videoHeight;\n      ctx.clearRect(0, 0, canvas.width, canvas.height);\n      ctx.strokeStyle = 'lime';\n      ctx.lineWidth = 2;\n      POSE_CONNECTIONS.forEach(([start, end]) => {\n        const s = landmarks[start];\n        const e = landmarks[end];\n        if (s && e && s.visibility > 0.5 && e.visibility > 0.5) {\n          ctx.beginPath();\n          ctx.moveTo(s.x * canvas.width, s.y * canvas.height);\n          ctx.lineTo(e.x * canvas.width, e.y * canvas.height);\n          ctx.stroke();\n        }\n      });\n      ctx.fillStyle = 'red';\n      landmarks.forEach(l => {\n        if (l.visibility > 0.5) {\n          ctx.beginPath();\n          ctx.arc(l.x * canvas.width, l.y * canvas.height, 4, 0, 2 * Math.PI);\n          ctx.fill();\n        }\n      });\n    }\n  }, [landmarks]);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"camera-wrapper\",\n    style: {\n      position: 'relative'\n    },\n    children: [/*#__PURE__*/_jsxDEV(\"video\", {\n      ref: videoRef,\n      autoPlay: true,\n      playsInline: true,\n      style: {\n        width: '100%',\n        transform: 'scaleX(-1)'\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 104,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"canvas\", {\n      ref: captureCanvasRef,\n      style: {\n        display: 'none'\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 110,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"canvas\", {\n      ref: drawCanvasRef,\n      style: {\n        position: 'absolute',\n        top: 0,\n        left: 0,\n        width: '100%',\n        height: '100%',\n        pointerEvents: 'none'\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 111,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 103,\n    columnNumber: 5\n  }, this);\n};\n_s(CameraFeed, \"OkcEdB7nW5OtTYlwPxQC9byl+l4=\");\n_c = CameraFeed;\nexport default CameraFeed;\nvar _c;\n$RefreshReg$(_c, \"CameraFeed\");","map":{"version":3,"names":["React","useRef","useEffect","jsxDEV","_jsxDEV","POSE_CONNECTIONS","CameraFeed","socket","landmarks","_s","videoRef","captureCanvasRef","drawCanvasRef","setupCamera","stream","navigator","mediaDevices","getUserMedia","video","current","srcObject","err","console","error","log","interval","setInterval","connected","videoWidth","canvas","context","getContext","width","height","videoHeight","drawImage","frame","toDataURL","emit","clearInterval","length","ctx","clearRect","strokeStyle","lineWidth","forEach","start","end","s","e","visibility","beginPath","moveTo","x","y","lineTo","stroke","fillStyle","l","arc","Math","PI","fill","className","style","position","children","ref","autoPlay","playsInline","transform","fileName","_jsxFileName","lineNumber","columnNumber","display","top","left","pointerEvents","_c","$RefreshReg$"],"sources":["/Users/abrahambhatti/Desktop/trainerAI/frontend/src/components/CameraFeed.js"],"sourcesContent":["import React, { useRef, useEffect } from 'react';\n\nconst POSE_CONNECTIONS = [\n  [11, 12], [11, 23], [12, 24], [23, 24],\n  [11, 13], [13, 15], [12, 14], [14, 16],\n  [23, 25], [25, 27], [24, 26], [26, 28],\n];\n\nconst CameraFeed = ({ socket, landmarks }) => {\n  const videoRef = useRef(null);\n  const captureCanvasRef = useRef(null);\n  const drawCanvasRef = useRef(null);\n\n  // Start camera\n  useEffect(() => {\n    const setupCamera = async () => {\n      try {\n        const stream = await navigator.mediaDevices.getUserMedia({ video: true });\n        if (videoRef.current) {\n          videoRef.current.srcObject = stream;\n        }\n      } catch (err) {\n        console.error('Error accessing camera: ', err);\n      }\n    };\n    setupCamera();\n  }, []);\n\n  // Send frames\n  useEffect(() => {\n    if (!socket) {\n      console.log('No socket yet in CameraFeed');\n      return;\n    }\n\n    const interval = setInterval(() => {\n      console.log(\n        'interval tick',\n        'hasSocket=', !!socket,\n        'connected=', socket.connected,\n        'videoWidth=', videoRef.current && videoRef.current.videoWidth\n      );\n\n      if (\n        socket.connected &&\n        videoRef.current &&\n        videoRef.current.videoWidth > 0\n      ) {\n        const canvas = captureCanvasRef.current;\n        const context = canvas.getContext('2d');\n\n        canvas.width = videoRef.current.videoWidth;\n        canvas.height = videoRef.current.videoHeight;\n\n        context.drawImage(videoRef.current, 0, 0, canvas.width, canvas.height);\n\n        const frame = canvas.toDataURL('image/jpeg');\n        console.log('Sending frame to backend');\n        socket.emit('video_frame', { frame });\n      }\n    }, 100);\n\n    return () => clearInterval(interval);\n  }, [socket]);\n\n  // Draw landmarks\n  useEffect(() => {\n    if (landmarks && landmarks.length > 0 && videoRef.current) {\n      const canvas = drawCanvasRef.current;\n      const ctx = canvas.getContext('2d');\n\n      canvas.width = videoRef.current.videoWidth;\n      canvas.height = videoRef.current.videoHeight;\n\n      ctx.clearRect(0, 0, canvas.width, canvas.height);\n\n      ctx.strokeStyle = 'lime';\n      ctx.lineWidth = 2;\n\n      POSE_CONNECTIONS.forEach(([start, end]) => {\n        const s = landmarks[start];\n        const e = landmarks[end];\n        if (s && e && s.visibility > 0.5 && e.visibility > 0.5) {\n          ctx.beginPath();\n          ctx.moveTo(s.x * canvas.width, s.y * canvas.height);\n          ctx.lineTo(e.x * canvas.width, e.y * canvas.height);\n          ctx.stroke();\n        }\n      });\n\n      ctx.fillStyle = 'red';\n      landmarks.forEach(l => {\n        if (l.visibility > 0.5) {\n          ctx.beginPath();\n          ctx.arc(l.x * canvas.width, l.y * canvas.height, 4, 0, 2 * Math.PI);\n          ctx.fill();\n        }\n      });\n    }\n  }, [landmarks]);\n\n  return (\n    <div className=\"camera-wrapper\" style={{ position: 'relative' }}>\n      <video\n        ref={videoRef}\n        autoPlay\n        playsInline\n        style={{ width: '100%', transform: 'scaleX(-1)' }}\n      />\n      <canvas ref={captureCanvasRef} style={{ display: 'none' }} />\n      <canvas\n        ref={drawCanvasRef}\n        style={{\n          position: 'absolute',\n          top: 0,\n          left: 0,\n          width: '100%',\n          height: '100%',\n          pointerEvents: 'none',\n        }}\n      />\n    </div>\n  );\n};\n\nexport default CameraFeed;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}